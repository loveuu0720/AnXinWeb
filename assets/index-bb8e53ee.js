import{a0 as ee,a as r,r as le,a1 as te,o as x,k as N,b as l,w as t,e as g,n as s,a4 as ae,ao as oe,d,at as ne,al as M,am as se,au as ie,c as de,a2 as re,E as y,g as ue,h as pe,i as me,j as ce,av as ge,a3 as fe,a7 as _e,an as ve,aa as ye,ab as be,ag as Ve,O as xe,_ as ke}from"./index-15d0a107.js";/* empty css                  *//* empty css                   *//* empty css                        *//* empty css                   *//* empty css                 *//* empty css                   *//* empty css                  *//* empty css                *//* empty css                    *//* empty css                     */import{g as we,s as Ce}from"./index-ca564672.js";import{h as z,b as k}from"./request-c66eae3e.js";import{m as Ee}from"./index-ca04d87c.js";const Ue=f=>z({url:"/drug/update",method:"post",data:f}),$e=f=>z({url:`/drug/remove/${f}`,method:"get"}),he=f=>z({url:`/drug/name/${f}`,method:"get"}),Ne={class:"allBtn"},Me={class:"left"},ze={class:"right"},Be=["src"],Ie=["src"],Ae={class:"dialog-footer"},Se=["src"],je={class:"dialog-footer"},De=ee({__name:"index",setup(f){const w=r(1),C=r(5),B=r(0),E=r([]),n=le({}),u=r(!1),p=r(!1),_=r();let I=r({fileName:""}),v=r("");const U=localStorage.getItem("user_token"),m=async()=>{try{let o=await we(w.value,C.value);o&&o.data&&(E.value=o.data.records||[],B.value=parseInt(o.data.total||0))}catch(o){console.error("Failed to fetch medical list:",o)}};te(()=>{m()});const F=o=>{Object.assign(n,o),u.value=!u.value,_.value=`${k}`+o.img},R=async o=>{(await $e(o)).data==="移除成功"?y.success("删除成功"):y.error("删除失败！"),m()},q=()=>{u.value=!u.value},L=async()=>{(await Ue(n)).data==="修改成功"?y.success("修改成功"):y.error("修改失败！"),u.value=!u.value,await m()},O=async()=>{p.value=!p.value,Object.assign(n,{drugname:"",id:"",img:"",price:""}),_.value=""},P=async o=>{p.value=!p.value,await Ee(n),m(),y.success("添加成功")},T=()=>{p.value=!p.value},A=async o=>{console.log(o),_.value=o.data,n.img=_.value},S={drugname:[{required:!0,message:"请输入药品!",trigger:"blur"}],price:[{required:!0,message:"请输入价格!",trigger:"blur"},{type:"number|string",message:"价格必须为数字!"}]},H=async o=>{I.value.fileName=o.data,(await Ce(I.value.fileName)).data==="添加成功"&&y.success("添加成功~"),m()},G=async()=>{let o=await he(v.value);E.value=o.data},J=async()=>{m(),v.value=""};return(o,e)=>{const b=ue,c=pe,i=me,$=ce,h=ge,j=fe,V=_e,K=ve,Q=ye,W=be,D=Ve,X=xe;return x(),N(re,null,[l(j,null,{default:t(()=>[g("div",Ne,[g("div",Me,[l($,{inline:!0},{default:t(()=>[l(c,{label:"查询药品"},{default:t(()=>[l(b,{placeholder:"请输入药品名称",modelValue:s(v),"onUpdate:modelValue":e[0]||(e[0]=a=>ae(v)?v.value=a:v=a)},null,8,["modelValue"])]),_:1}),l(c,null,{default:t(()=>[l(i,{type:"primary",size:"default",title:"请添加搜索条件",onClick:G,icon:s(oe)},{default:t(()=>[...e[11]||(e[11]=[d("搜索",-1)])]),_:1},8,["icon"]),l(i,{icon:s(ne),onClick:J},{default:t(()=>[...e[12]||(e[12]=[d("重置",-1)])]),_:1},8,["icon"])]),_:1})]),_:1})]),g("div",ze,[l(i,{type:"primary",icon:s(M),onClick:O},{default:t(()=>[...e[13]||(e[13]=[d("新增药品",-1)])]),_:1},8,["icon"]),l(h,{class:"upload-demo",action:`${s(k)}/common/upload/excel`,multiple:"",headers:{token:s(U)},"on-success":H},{default:t(()=>[l(i,{type:"success",icon:s(M)},{default:t(()=>[...e[14]||(e[14]=[d("Excel文件导入药品",-1)])]),_:1},8,["icon"])]),_:1},8,["action","headers"])])])]),_:1}),l(j,{style:{"margin-top":"5px"}},{default:t(()=>[e[21]||(e[21]=g("h1",{class:"title"},"药品管理",-1)),l(Q,{border:"",style:{margin:"10px 0px"},data:E.value},{default:t(()=>[l(V,{label:"序号",width:"60px",type:"index",align:"center"}),l(V,{label:"药品名称",prop:"drugname",align:"center","show-overflow-tooltip":""}),l(V,{label:"价格",prop:"price",align:"center","show-overflow-tooltip":""}),l(V,{label:"药品图片",align:"center"},{default:t(({row:a,$index:Y})=>[g("img",{src:a.img,style:{width:"100px",height:"100px"}},null,8,Be)]),_:1}),l(V,{label:"操作",align:"center"},{default:t(({row:a,$index:Y})=>[l(i,{type:"primary",icon:o.Edit,onClick:Z=>F(a)},{default:t(()=>[...e[15]||(e[15]=[d("编辑",-1)])]),_:1},8,["icon","onClick"]),l(K,{title:"你确定要删除吗?",onConfirm:Z=>R(a.id)},{reference:t(()=>[l(i,{type:"danger",icon:s(se)},{default:t(()=>[...e[16]||(e[16]=[d("删除",-1)])]),_:1},8,["icon"])]),_:1},8,["onConfirm"])]),_:1})]),_:1},8,["data"]),l(W,{"current-page":w.value,"onUpdate:currentPage":e[1]||(e[1]=a=>w.value=a),"page-size":C.value,"onUpdate:pageSize":e[2]||(e[2]=a=>C.value=a),"page-sizes":[5,10,15],background:!0,layout:" prev, pager, next, jumper,->,sizes,total",total:B.value,onSizeChange:e[3]||(e[3]=a=>m()),onCurrentChange:e[4]||(e[4]=a=>m())},null,8,["current-page","page-size","total"]),l(D,{modelValue:u.value,"onUpdate:modelValue":e[7]||(e[7]=a=>u.value=a),title:"修改药品",width:"30%",center:""},{footer:t(()=>[g("span",Ae,[l(i,{onClick:q},{default:t(()=>[...e[17]||(e[17]=[d("取消",-1)])]),_:1}),l(i,{type:"primary",onClick:L},{default:t(()=>[...e[18]||(e[18]=[d("确认修改",-1)])]),_:1})])]),default:t(()=>[l($,{rules:S,model:n,"label-position":"left","label-width":"80px"},{default:t(()=>[l(c,{label:"药品名称",prop:"name"},{default:t(()=>[l(b,{modelValue:n.drugname,"onUpdate:modelValue":e[5]||(e[5]=a=>n.drugname=a),placeholder:"请输入药品名称"},null,8,["modelValue"])]),_:1}),l(c,{label:"单价",prop:"price"},{default:t(()=>[l(b,{modelValue:n.price,"onUpdate:modelValue":e[6]||(e[6]=a=>n.price=a),placeholder:"请输入药品单价"},null,8,["modelValue"])]),_:1}),l(c,{label:"药品图片"},{default:t(()=>[l(h,{class:"avatar-uploader",action:`${s(k)}/common/upload/img`,"show-file-list":!1,"on-success":A,headers:{token:s(U)}},{default:t(()=>[_.value?(x(),N("img",{key:0,src:`${n.img}`,class:"avatar"},null,8,Ie)):ie("",!0)]),_:1},8,["action","headers"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(D,{modelValue:p.value,"onUpdate:modelValue":e[10]||(e[10]=a=>p.value=a),title:"新增药品",width:"30%",center:""},{footer:t(()=>[g("span",je,[l(i,{onClick:T},{default:t(()=>[...e[19]||(e[19]=[d("取消",-1)])]),_:1}),l(i,{type:"primary",onClick:P},{default:t(()=>[...e[20]||(e[20]=[d("确认",-1)])]),_:1})])]),default:t(()=>[l($,{rules:S,model:n,"label-position":"left","label-width":"80px"},{default:t(()=>[l(c,{label:"药品名称",prop:"drugname"},{default:t(()=>[l(b,{modelValue:n.drugname,"onUpdate:modelValue":e[8]||(e[8]=a=>n.drugname=a),placeholder:"请输入药品名称"},null,8,["modelValue"])]),_:1}),l(c,{label:"单价",prop:"price"},{default:t(()=>[l(b,{modelValue:n.price,"onUpdate:modelValue":e[9]||(e[9]=a=>n.price=a),placeholder:"请输入药品单价"},null,8,["modelValue"])]),_:1}),l(c,{label:"药品图片"},{default:t(()=>[l(h,{"list-type":"picture-card",action:`${s(k)}/common/upload/img`,"show-file-list":!1,headers:{token:s(U)},"on-success":A},{default:t(()=>[_.value?(x(),N("img",{key:0,style:{width:"100%",height:"100%"},src:`${n.img}`},null,8,Se)):(x(),de(X,{key:1,class:"el-upload-list__item-actions"},{default:t(()=>[l(s(M))]),_:1}))]),_:1},8,["action","headers"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),_:1})],64)}}});const Ye=ke(De,[["__scopeId","data-v-5727d290"]]);export{Ye as default};
